{"ast":null,"code":"import React,{useState}from'react';import Modal from'../Common/Modal';import{useForm}from'react-hook-form';import{CalendarIcon,CurrencyDollarIcon}from'@heroicons/react/24/outline';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const LeaseRenewalModal=_ref=>{let{isOpen,onClose,lease,onSubmit}=_ref;const[isSubmitting,setIsSubmitting]=useState(false);const{register,handleSubmit,watch,setValue,formState:{errors}}=useForm();const currentRent=lease.monthlyRent||lease.rent_amount||0;const currentDeposit=lease.securityDeposit||lease.security_deposit||0;const watchedRentIncrease=watch('rentIncrease',0);const watchedNewRent=watch('newMonthlyRent',currentRent);// Calculate suggested dates\nconst currentEndDate=new Date(lease.endDate||lease.end_date||new Date());const suggestedStartDate=new Date(currentEndDate);suggestedStartDate.setDate(suggestedStartDate.getDate()+1);const suggestedEndDate=new Date(suggestedStartDate);suggestedEndDate.setFullYear(suggestedEndDate.getFullYear()+1);React.useEffect(()=>{// Set default values\nsetValue('newStartDate',suggestedStartDate.toISOString().split('T')[0]);setValue('newEndDate',suggestedEndDate.toISOString().split('T')[0]);setValue('newMonthlyRent',currentRent);setValue('newSecurityDeposit',currentDeposit);setValue('renewalType','fixed');setValue('rentIncrease',0);},[lease,setValue]);// Update rent when rent increase changes\nReact.useEffect(()=>{const rentIncreaseAmount=typeof watchedRentIncrease==='number'?watchedRentIncrease:parseFloat(watchedRentIncrease)||0;const newRent=currentRent+rentIncreaseAmount;console.log('ðŸ  LeaseRenewal - Rent calculation:',{currentRent,rentIncreaseAmount,newRent,watchedRentIncrease,watchedRentIncreaseType:typeof watchedRentIncrease});setValue('newMonthlyRent',Math.round(newRent*100)/100);// Ensure proper currency precision\n},[watchedRentIncrease,currentRent,setValue]);const onFormSubmit=async data=>{try{setIsSubmitting(true);await onSubmit(data);toast.success('Lease renewal submitted successfully!');onClose();}catch(error){toast.error('Failed to submit lease renewal');}finally{setIsSubmitting(false);}};const tenantName=lease.tenant_name||'Unknown Tenant';const propertyName=lease.property_name||'Unknown Property';return/*#__PURE__*/_jsx(Modal,{isOpen:isOpen,onClose:onClose,title:\"Renew Lease\",maxWidth:\"2xl\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onFormSubmit),className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 rounded-lg p-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 mb-2\",children:\"Current Lease\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-500\",children:\"Tenant:\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-900\",children:tenantName})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-500\",children:\"Property:\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-900\",children:propertyName})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-500\",children:\"Current Rent:\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-900\",children:[\"$\",currentRent.toLocaleString(),\"/month\"]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-500\",children:\"Expires:\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-900\",children:lease.endDate||lease.end_date?new Date(lease.endDate||lease.end_date||'').toLocaleDateString():'N/A'})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900\",children:\"New Lease Terms\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newStartDate\",className:\"block text-sm font-medium text-gray-700\",children:\"New Start Date\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-1 relative\",children:[/*#__PURE__*/_jsx(CalendarIcon,{className:\"absolute left-3 top-3 h-5 w-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",id:\"newStartDate\",...register('newStartDate',{required:'Start date is required'}),className:\"pl-10 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500\"})]}),errors.newStartDate&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-red-600\",children:errors.newStartDate.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newEndDate\",className:\"block text-sm font-medium text-gray-700\",children:\"New End Date\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-1 relative\",children:[/*#__PURE__*/_jsx(CalendarIcon,{className:\"absolute left-3 top-3 h-5 w-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",id:\"newEndDate\",...register('newEndDate',{required:'End date is required'}),className:\"pl-10 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500\"})]}),errors.newEndDate&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-red-600\",children:errors.newEndDate.message})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"renewalType\",className:\"block text-sm font-medium text-gray-700\",children:\"Renewal Type\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"renewalType\",...register('renewalType',{required:'Renewal type is required'}),className:\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"fixed\",children:\"Fixed Term\"}),/*#__PURE__*/_jsx(\"option\",{value:\"month-to-month\",children:\"Month-to-Month\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"rentIncrease\",className:\"block text-sm font-medium text-gray-700\",children:\"Rent Increase ($)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-1 relative\",children:[/*#__PURE__*/_jsx(CurrencyDollarIcon,{className:\"absolute left-3 top-3 h-5 w-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",id:\"rentIncrease\",step:\"1\",min:\"0\",placeholder:\"100\",...register('rentIncrease',{min:{value:0,message:'Rent increase cannot be negative'},valueAsNumber:true,setValueAs:value=>{// Ensure we get a proper number, round to nearest cent\nconst num=parseFloat(value);return isNaN(num)?0:Math.round(num*100)/100;}}),className:\"pl-10 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500\"})]}),errors.rentIncrease&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-red-600\",children:errors.rentIncrease.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newMonthlyRent\",className:\"block text-sm font-medium text-gray-700\",children:\"New Monthly Rent\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-1 relative\",children:[/*#__PURE__*/_jsx(CurrencyDollarIcon,{className:\"absolute left-3 top-3 h-5 w-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",id:\"newMonthlyRent\",step:\"0.01\",...register('newMonthlyRent',{required:'Monthly rent is required',min:{value:1,message:'Rent must be greater than 0'}}),className:\"pl-10 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500 bg-gray-50\",readOnly:true})]}),errors.newMonthlyRent&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-red-600\",children:errors.newMonthlyRent.message})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newSecurityDeposit\",className:\"block text-sm font-medium text-gray-700\",children:\"Security Deposit\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-1 relative\",children:[/*#__PURE__*/_jsx(CurrencyDollarIcon,{className:\"absolute left-3 top-3 h-5 w-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",id:\"newSecurityDeposit\",step:\"0.01\",...register('newSecurityDeposit',{required:'Security deposit is required',min:{value:0,message:'Security deposit cannot be negative'}}),className:\"pl-10 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500\"})]}),errors.newSecurityDeposit&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-red-600\",children:errors.newSecurityDeposit.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"notes\",className:\"block text-sm font-medium text-gray-700\",children:\"Renewal Notes\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"notes\",rows:3,...register('notes'),placeholder:\"Any additional terms or conditions for the renewal...\",className:\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-blue-50 rounded-lg p-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-md font-medium text-blue-900 mb-2\",children:\"Renewal Summary\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-blue-800 space-y-1\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Current rent: $\",currentRent.toLocaleString(),\"/month\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"New rent: $\",watchedNewRent.toLocaleString(),\"/month\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Increase: $\",watchedRentIncrease||0,\"/month (\",((watchedRentIncrease||0)/currentRent*100||0).toFixed(1),\"%)\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end space-x-3 pt-4 border-t border-gray-200\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2\",onClick:onClose,children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:isSubmitting,className:\"px-4 py-2 text-sm font-medium text-white bg-green-600 border border-transparent rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 disabled:opacity-50\",children:isSubmitting?'Processing...':'Create Renewal'})]})]})});};export default LeaseRenewalModal;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}