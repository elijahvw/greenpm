{"ast":null,"code":"import React,{useState}from'react';import{useForm}from'react-hook-form';import Modal from'../Common/Modal';import{CalendarIcon,BanknotesIcon,DocumentTextIcon}from'@heroicons/react/24/outline';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProcessRefundModal=_ref=>{let{isOpen,onClose,depositId,depositAmount,totalDeductions,tenantName,propertyAddress,onSubmit}=_ref;const[isSubmitting,setIsSubmitting]=useState(false);const{register,handleSubmit,reset,formState:{errors}}=useForm({defaultValues:{refundDate:new Date().toISOString().split('T')[0],// Today's date\nrefundMethod:'check'}});const refundAmount=Math.max(0,depositAmount-totalDeductions);const onFormSubmit=async data=>{try{setIsSubmitting(true);const refundData={refundDate:data.refundDate,refundMethod:data.refundMethod,refundNotes:data.refundNotes||undefined};await onSubmit(depositId,refundData);toast.success('Refund processed successfully');reset();onClose();}catch(error){console.error('Error processing refund:',error);toast.error('Failed to process refund');}finally{setIsSubmitting(false);}};const handleClose=()=>{reset();onClose();};const formatCurrency=amount=>{return new Intl.NumberFormat('en-US',{style:'currency',currency:'USD',minimumFractionDigits:0,maximumFractionDigits:0}).format(amount);};const formatDate=dateString=>{return new Date(dateString).toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'});};return/*#__PURE__*/_jsx(Modal,{isOpen:isOpen,onClose:handleClose,title:\"Process Security Deposit Refund\",maxWidth:\"lg\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onFormSubmit),className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 rounded-lg p-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium text-gray-900 mb-2\",children:\"Refund Details\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2 text-sm\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-500\",children:\"Tenant:\"}),\" \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:tenantName})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-500\",children:\"Property:\"}),\" \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:propertyAddress})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-blue-50 rounded-lg p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"Original Deposit\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg font-semibold text-gray-900\",children:formatCurrency(depositAmount)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"Total Deductions\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-lg font-semibold text-red-600\",children:[\"-\",formatCurrency(totalDeductions)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"Refund Amount\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-green-600\",children:formatCurrency(refundAmount)})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:[/*#__PURE__*/_jsx(CalendarIcon,{className:\"inline h-4 w-4 mr-1\"}),\"Refund Date *\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",...register('refundDate',{required:'Refund date is required',validate:{notFuture:value=>{const selectedDate=new Date(value);const today=new Date();today.setHours(23,59,59,999);// End of today\nreturn selectedDate<=today||'Refund date cannot be in the future';}}}),className:\"block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500\"}),errors.refundDate&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-red-600\",children:errors.refundDate.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:[/*#__PURE__*/_jsx(BanknotesIcon,{className:\"inline h-4 w-4 mr-1\"}),\"Refund Method *\"]}),/*#__PURE__*/_jsxs(\"select\",{...register('refundMethod',{required:'Refund method is required'}),className:\"block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"check\",children:\"Check\"}),/*#__PURE__*/_jsx(\"option\",{value:\"bank_transfer\",children:\"Bank Transfer\"}),/*#__PURE__*/_jsx(\"option\",{value:\"cash\",children:\"Cash\"})]}),errors.refundMethod&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-red-600\",children:errors.refundMethod.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:[/*#__PURE__*/_jsx(DocumentTextIcon,{className:\"inline h-4 w-4 mr-1\"}),\"Refund Notes (Optional)\"]}),/*#__PURE__*/_jsx(\"textarea\",{...register('refundNotes'),rows:3,className:\"block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500\",placeholder:\"Check number, transfer details, or other notes...\"})]})]}),refundAmount===0?/*#__PURE__*/_jsx(\"div\",{className:\"rounded-md bg-yellow-50 p-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"ml-3\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-medium text-yellow-800\",children:\"No Refund Due\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 text-sm text-yellow-700\",children:/*#__PURE__*/_jsx(\"p\",{children:\"The total deductions equal or exceed the original deposit amount. Processing this will mark the deposit as fully processed with no refund.\"})})]})})}):/*#__PURE__*/_jsx(\"div\",{className:\"rounded-md bg-green-50 p-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"ml-3\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-medium text-green-800\",children:\"Ready to Process\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 text-sm text-green-700\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"A refund of \",/*#__PURE__*/_jsx(\"strong\",{children:formatCurrency(refundAmount)}),\" will be processed for \",tenantName,\". This action cannot be undone.\"]})})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleClose,className:\"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:isSubmitting,className:\"px-4 py-2 text-sm font-medium text-white bg-green-600 border border-transparent rounded-md shadow-sm hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50\",children:isSubmitting?'Processing...':`Process ${refundAmount>0?'Refund':'Completion'}`})]})]})});};export default ProcessRefundModal;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}