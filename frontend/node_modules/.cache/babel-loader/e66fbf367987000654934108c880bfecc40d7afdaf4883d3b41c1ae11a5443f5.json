{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{useAuth}from'../contexts/AuthContext';import{leaseService}from'../services/leaseService';import toast from'react-hot-toast';import{HomeIcon,CurrencyDollarIcon,CalendarIcon,ExclamationTriangleIcon,CheckCircleIcon,WrenchScrewdriverIcon}from'@heroicons/react/24/outline';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const TenantDashboard=()=>{const{user}=useAuth();const navigate=useNavigate();const[currentLease,setCurrentLease]=useState(null);const[loading,setLoading]=useState(true);useEffect(()=>{fetchCurrentLease();},[]);const fetchCurrentLease=async()=>{try{// For now, get the first active lease for the user\nconst leases=await leaseService.getLeases();const activeLease=leases.find(lease=>lease.status==='active'&&lease.tenant_email===(user===null||user===void 0?void 0:user.email));setCurrentLease(activeLease||null);}catch(error){console.error('Error fetching lease:',error);}finally{setLoading(false);}};const getDaysUntilRent=()=>{const today=new Date();const nextMonth=new Date(today.getFullYear(),today.getMonth()+1,1);const diffTime=nextMonth.getTime()-today.getTime();return Math.ceil(diffTime/(1000*60*60*24));};const getDaysUntilExpiry=()=>{if(!(currentLease!==null&&currentLease!==void 0&&currentLease.end_date))return 0;const today=new Date();const endDate=new Date(currentLease.end_date);const diffTime=endDate.getTime()-today.getTime();return Math.ceil(diffTime/(1000*60*60*24));};const daysUntilRent=getDaysUntilRent();const daysUntilExpiry=getDaysUntilExpiry();const isExpiringSoon=daysUntilExpiry<=60&&daysUntilExpiry>0;// Button handlers\nconst handlePayRent=()=>{toast.success('Redirecting to rent payment portal...');navigate('/dashboard/payments');};const handleContactLandlord=()=>{toast.success('Opening message to landlord...');navigate('/dashboard/communication');};const handleMaintenanceRequest=()=>{toast.success('Opening maintenance request form...');navigate('/dashboard/maintenance');};const handlePaymentHistory=()=>{navigate('/dashboard/payment-history');};const handleLeaseDetails=()=>{navigate('/dashboard/lease');};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-64\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white shadow rounded-lg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"px-4 py-5 sm:p-6\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"text-2xl font-bold text-gray-900\",children:[\"Welcome back, \",user===null||user===void 0?void 0:user.first_name,\"!\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-gray-600\",children:\"Here's an overview of your rental information.\"})]})}),!currentLease?/*#__PURE__*/_jsx(\"div\",{className:\"bg-yellow-50 border border-yellow-200 rounded-lg p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex\",children:[/*#__PURE__*/_jsx(ExclamationTriangleIcon,{className:\"h-5 w-5 text-yellow-400 mr-3\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-medium text-yellow-800\",children:\"No Active Lease\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-yellow-700\",children:\"You don't currently have an active lease. Please contact your landlord.\"})]})]})}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white shadow rounded-lg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"px-4 py-5 sm:p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-medium text-gray-900 mb-4\",children:\"Current Lease\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 rounded-lg p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(HomeIcon,{className:\"h-8 w-8 text-blue-600\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-500\",children:\"Property\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg font-semibold text-gray-900\",children:currentLease.property_name||'Your Property'})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 rounded-lg p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(CurrencyDollarIcon,{className:\"h-8 w-8 text-green-600\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-500\",children:\"Monthly Rent\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-lg font-semibold text-gray-900\",children:[\"$\",(currentLease.rent_amount||0).toLocaleString()]})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 rounded-lg p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(CalendarIcon,{className:\"h-8 w-8 text-purple-600\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-500\",children:\"Lease Ends\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg font-semibold text-gray-900\",children:currentLease.end_date?new Date(currentLease.end_date).toLocaleDateString():'N/A'})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 rounded-lg p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(CheckCircleIcon,{className:\"h-8 w-8 text-green-500\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-500\",children:\"Status\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg font-semibold text-green-600 capitalize\",children:currentLease.status||'Active'})]})]})})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white shadow rounded-lg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"px-4 py-5 sm:p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:`p-2 rounded-lg ${daysUntilRent<=7?'bg-red-100':'bg-blue-100'}`,children:/*#__PURE__*/_jsx(CurrencyDollarIcon,{className:`h-6 w-6 ${daysUntilRent<=7?'text-red-600':'text-blue-600'}`})}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900\",children:\"Next Rent Payment\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:daysUntilRent<=7?/*#__PURE__*/_jsxs(\"span\",{className:\"text-red-600 font-medium\",children:[\"Due in \",daysUntilRent,\" days\"]}):/*#__PURE__*/_jsxs(\"span\",{children:[\"Due in \",daysUntilRent,\" days\"]})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:handlePayRent,className:\"w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2\",children:[\"Pay Rent - $\",(currentLease.rent_amount||0).toLocaleString()]})})]})}),isExpiringSoon&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-white shadow rounded-lg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"px-4 py-5 sm:p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-2 rounded-lg bg-orange-100\",children:/*#__PURE__*/_jsx(ExclamationTriangleIcon,{className:\"h-6 w-6 text-orange-600\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900\",children:\"Lease Expiring\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"text-orange-600 font-medium\",children:[\"Expires in \",daysUntilExpiry,\" days\"]})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4\",children:/*#__PURE__*/_jsx(\"button\",{onClick:handleContactLandlord,className:\"w-full bg-orange-600 text-white py-2 px-4 rounded-md hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2\",children:\"Contact Landlord About Renewal\"})})]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white shadow rounded-lg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"px-4 py-5 sm:p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 mb-4\",children:\"Quick Actions\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:handleMaintenanceRequest,className:\"flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors\",children:[/*#__PURE__*/_jsx(WrenchScrewdriverIcon,{className:\"h-8 w-8 text-blue-600\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-4 text-left\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-900\",children:\"Request Maintenance\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:\"Submit a repair request\"})]})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:handlePaymentHistory,className:\"flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors\",children:[/*#__PURE__*/_jsx(CurrencyDollarIcon,{className:\"h-8 w-8 text-green-600\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-4 text-left\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-900\",children:\"Payment History\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:\"View past payments\"})]})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleLeaseDetails,className:\"flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors\",children:[/*#__PURE__*/_jsx(HomeIcon,{className:\"h-8 w-8 text-purple-600\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-4 text-left\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-900\",children:\"Lease Details\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:\"View lease agreement\"})]})]})]})]})})]})]});};export default TenantDashboard;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}